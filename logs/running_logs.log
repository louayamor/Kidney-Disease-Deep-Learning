[2025-04-27 17:15:55,623: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2025-04-27 17:15:55,624: INFO: common: yaml file: config/config.yaml loaded successfully]
[2025-04-27 17:15:55,626: INFO: common: yaml file: params.yaml loaded successfully]
[2025-04-27 17:15:55,626: INFO: common: created directory at: artifacts]
[2025-04-27 17:15:55,626: INFO: common: created directory at: artifacts/data_ingestion]
[2025-04-27 17:15:55,626: INFO: data_ingestion: Downloading data from https://drive.google.com/file/d/1vlhZ5c7abUKF8xXERIw6m9Te8fW7ohw3/view?usp=sharing into file artifacts/data_ingestion/data.zip]
[2025-04-27 17:16:59,534: INFO: data_ingestion: Downloaded data from https://drive.google.com/file/d/1vlhZ5c7abUKF8xXERIw6m9Te8fW7ohw3/view?usp=sharing into file artifacts/data_ingestion/data.zip]
[2025-04-27 17:16:59,861: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2025-04-27 17:16:59,861: INFO: main: *******************]
[2025-04-27 17:16:59,861: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2025-04-27 17:16:59,862: INFO: common: yaml file: config/config.yaml loaded successfully]
[2025-04-27 17:16:59,863: INFO: common: yaml file: params.yaml loaded successfully]
[2025-04-27 17:16:59,863: INFO: common: created directory at: artifacts]
[2025-04-27 17:16:59,863: INFO: common: created directory at: artifacts/prepare_base_model]
[2025-04-27 17:18:03,738: WARNING: saving_utils: Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.]
[2025-04-27 17:18:03,870: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2025-04-27 17:18:03,870: INFO: main: *******************]
[2025-04-27 17:18:03,871: INFO: main: >>>>>> stage Training started <<<<<<]
[2025-04-27 17:18:03,872: INFO: common: yaml file: config/config.yaml loaded successfully]
[2025-04-27 17:18:03,873: INFO: common: yaml file: params.yaml loaded successfully]
[2025-04-27 17:18:03,873: INFO: common: created directory at: artifacts]
[2025-04-27 17:18:03,873: INFO: common: created directory at: artifacts/training]
[2025-04-27 17:18:04,136: ERROR: main: Could not import PIL.Image. The use of `load_img` requires PIL.]
Traceback (most recent call last):
  File "/home/louay/PycharmProjects/KidneyDisease/main.py", line 42, in <module>
    model_trainer.main()
  File "/home/louay/PycharmProjects/KidneyDisease/cnnClassifier/pipeline/stage_03_model_training.py", line 21, in main
    training.train()
  File "/home/louay/PycharmProjects/KidneyDisease/cnnClassifier/components/model_training.py", line 76, in train
    self.model.fit(
  File "/home/louay/PycharmProjects/KidneyDisease/.venv3.10/lib/python3.10/site-packages/keras/utils/traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/home/louay/PycharmProjects/KidneyDisease/.venv3.10/lib/python3.10/site-packages/keras/utils/image_utils.py", line 414, in load_img
    raise ImportError(
ImportError: Could not import PIL.Image. The use of `load_img` requires PIL.
[2025-04-27 17:21:23,964: INFO: main: >>>>>> stage Data Ingestion stage started <<<<<<]
[2025-04-27 17:21:23,965: INFO: common: yaml file: config/config.yaml loaded successfully]
[2025-04-27 17:21:23,966: INFO: common: yaml file: params.yaml loaded successfully]
[2025-04-27 17:21:23,966: INFO: common: created directory at: artifacts]
[2025-04-27 17:21:23,966: INFO: common: created directory at: artifacts/data_ingestion]
[2025-04-27 17:21:23,966: INFO: data_ingestion: Downloading data from https://drive.google.com/file/d/1vlhZ5c7abUKF8xXERIw6m9Te8fW7ohw3/view?usp=sharing into file artifacts/data_ingestion/data.zip]
[2025-04-27 17:22:31,903: INFO: data_ingestion: Downloaded data from https://drive.google.com/file/d/1vlhZ5c7abUKF8xXERIw6m9Te8fW7ohw3/view?usp=sharing into file artifacts/data_ingestion/data.zip]
[2025-04-27 17:22:32,301: INFO: main: >>>>>> stage Data Ingestion stage completed <<<<<<

x==========x]
[2025-04-27 17:22:32,301: INFO: main: *******************]
[2025-04-27 17:22:32,301: INFO: main: >>>>>> stage Prepare base model started <<<<<<]
[2025-04-27 17:22:32,302: INFO: common: yaml file: config/config.yaml loaded successfully]
[2025-04-27 17:22:32,303: INFO: common: yaml file: params.yaml loaded successfully]
[2025-04-27 17:22:32,304: INFO: common: created directory at: artifacts]
[2025-04-27 17:22:32,304: INFO: common: created directory at: artifacts/prepare_base_model]
[2025-04-27 17:22:34,269: WARNING: saving_utils: Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.]
[2025-04-27 17:22:34,477: INFO: main: >>>>>> stage Prepare base model completed <<<<<<

x==========x]
[2025-04-27 17:22:34,477: INFO: main: *******************]
[2025-04-27 17:22:34,477: INFO: main: >>>>>> stage Training started <<<<<<]
[2025-04-27 17:22:34,479: INFO: common: yaml file: config/config.yaml loaded successfully]
[2025-04-27 17:22:34,480: INFO: common: yaml file: params.yaml loaded successfully]
[2025-04-27 17:22:34,480: INFO: common: created directory at: artifacts]
[2025-04-27 17:22:34,480: INFO: common: created directory at: artifacts/training]
[2025-04-27 17:23:27,754: INFO: main: >>>>>> stage Training completed <<<<<<

x==========x]
[2025-04-27 17:23:27,754: INFO: main: *******************]
[2025-04-27 17:23:27,754: INFO: main: >>>>>> stage Evaluation stage started <<<<<<]
[2025-04-27 17:23:27,756: INFO: common: yaml file: config/config.yaml loaded successfully]
[2025-04-27 17:23:27,757: INFO: common: yaml file: params.yaml loaded successfully]
[2025-04-27 17:23:27,757: INFO: common: created directory at: artifacts]
[2025-04-27 17:23:42,761: INFO: common: json file saved at: scores.json]
[2025-04-27 17:23:42,761: INFO: common: json file saved at: scores.json]
[2025-04-27 17:23:42,761: INFO: main: >>>>>> stage Evaluation stage completed <<<<<<

x==========x]
[2025-04-27 18:31:51,685: INFO: _internal: [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8089
 * Running on http://192.168.1.15:8089]
[2025-04-27 18:31:51,685: INFO: _internal: [33mPress CTRL+C to quit[0m]
[2025-04-27 18:31:57,046: INFO: _internal: 127.0.0.1 - - [27/Apr/2025 18:31:57] "GET / HTTP/1.1" 200 -]
[2025-04-27 18:31:57,414: INFO: _internal: 127.0.0.1 - - [27/Apr/2025 18:31:57] "[33mGET /Roboto-Regular.ttf HTTP/1.1[0m" 404 -]
[2025-04-27 18:32:13,351: INFO: _internal: 127.0.0.1 - - [27/Apr/2025 18:32:13] "POST /predict HTTP/1.1" 200 -]
[2025-04-27 18:33:44,793: INFO: _internal: 127.0.0.1 - - [27/Apr/2025 18:33:44] "POST /predict HTTP/1.1" 200 -]
[2025-04-27 22:12:08,801: INFO: _internal: 127.0.0.1 - - [27/Apr/2025 22:12:08] "POST /predict HTTP/1.1" 200 -]
[2025-04-27 22:12:30,348: INFO: _internal: 127.0.0.1 - - [27/Apr/2025 22:12:30] "POST /predict HTTP/1.1" 200 -]
[2025-04-27 22:13:46,486: ERROR: app: Exception on /predict [POST]]
Traceback (most recent call last):
  File "/home/louay/PycharmProjects/KidneyDisease/.venv3.10/lib/python3.10/site-packages/flask/app.py", line 2190, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/louay/PycharmProjects/KidneyDisease/.venv3.10/lib/python3.10/site-packages/flask/app.py", line 1486, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/louay/PycharmProjects/KidneyDisease/.venv3.10/lib/python3.10/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "/home/louay/PycharmProjects/KidneyDisease/.venv3.10/lib/python3.10/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/louay/PycharmProjects/KidneyDisease/.venv3.10/lib/python3.10/site-packages/flask/app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "/home/louay/PycharmProjects/KidneyDisease/.venv3.10/lib/python3.10/site-packages/flask_cors/decorator.py", line 121, in wrapped_function
    resp = make_response(f(*args, **kwargs))
  File "/home/louay/PycharmProjects/KidneyDisease/app.py", line 44, in predictRoute
    result = clApp.classifier.predict()
  File "/home/louay/PycharmProjects/KidneyDisease/cnnClassifier/pipeline/prediction.py", line 19, in predict
    test_image = image.load_img(imagename, target_size = (224,224))
  File "/home/louay/PycharmProjects/KidneyDisease/.venv3.10/lib/python3.10/site-packages/keras/utils/image_utils.py", line 423, in load_img
    img = pil_image.open(io.BytesIO(f.read()))
  File "/home/louay/PycharmProjects/KidneyDisease/.venv3.10/lib/python3.10/site-packages/PIL/Image.py", line 3572, in open
    raise UnidentifiedImageError(msg)
PIL.UnidentifiedImageError: cannot identify image file <_io.BytesIO object at 0x723100160c70>
[2025-04-27 22:13:46,488: INFO: _internal: 127.0.0.1 - - [27/Apr/2025 22:13:46] "[35m[1mPOST /predict HTTP/1.1[0m" 500 -]
[2025-04-27 22:15:17,569: ERROR: app: Exception on /predict [POST]]
Traceback (most recent call last):
  File "/home/louay/PycharmProjects/KidneyDisease/.venv3.10/lib/python3.10/site-packages/flask/app.py", line 2190, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/louay/PycharmProjects/KidneyDisease/.venv3.10/lib/python3.10/site-packages/flask/app.py", line 1486, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/louay/PycharmProjects/KidneyDisease/.venv3.10/lib/python3.10/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "/home/louay/PycharmProjects/KidneyDisease/.venv3.10/lib/python3.10/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/louay/PycharmProjects/KidneyDisease/.venv3.10/lib/python3.10/site-packages/flask/app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "/home/louay/PycharmProjects/KidneyDisease/.venv3.10/lib/python3.10/site-packages/flask_cors/decorator.py", line 121, in wrapped_function
    resp = make_response(f(*args, **kwargs))
  File "/home/louay/PycharmProjects/KidneyDisease/app.py", line 44, in predictRoute
    result = clApp.classifier.predict()
  File "/home/louay/PycharmProjects/KidneyDisease/cnnClassifier/pipeline/prediction.py", line 19, in predict
    test_image = image.load_img(imagename, target_size = (224,224))
  File "/home/louay/PycharmProjects/KidneyDisease/.venv3.10/lib/python3.10/site-packages/keras/utils/image_utils.py", line 423, in load_img
    img = pil_image.open(io.BytesIO(f.read()))
  File "/home/louay/PycharmProjects/KidneyDisease/.venv3.10/lib/python3.10/site-packages/PIL/Image.py", line 3572, in open
    raise UnidentifiedImageError(msg)
PIL.UnidentifiedImageError: cannot identify image file <_io.BytesIO object at 0x723100228400>
[2025-04-27 22:15:17,570: INFO: _internal: 127.0.0.1 - - [27/Apr/2025 22:15:17] "[35m[1mPOST /predict HTTP/1.1[0m" 500 -]
[2025-04-27 22:15:28,265: ERROR: app: Exception on /predict [POST]]
Traceback (most recent call last):
  File "/home/louay/PycharmProjects/KidneyDisease/.venv3.10/lib/python3.10/site-packages/flask/app.py", line 2190, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/louay/PycharmProjects/KidneyDisease/.venv3.10/lib/python3.10/site-packages/flask/app.py", line 1486, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/louay/PycharmProjects/KidneyDisease/.venv3.10/lib/python3.10/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
  File "/home/louay/PycharmProjects/KidneyDisease/.venv3.10/lib/python3.10/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/louay/PycharmProjects/KidneyDisease/.venv3.10/lib/python3.10/site-packages/flask/app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
  File "/home/louay/PycharmProjects/KidneyDisease/.venv3.10/lib/python3.10/site-packages/flask_cors/decorator.py", line 121, in wrapped_function
    resp = make_response(f(*args, **kwargs))
  File "/home/louay/PycharmProjects/KidneyDisease/app.py", line 44, in predictRoute
    result = clApp.classifier.predict()
  File "/home/louay/PycharmProjects/KidneyDisease/cnnClassifier/pipeline/prediction.py", line 19, in predict
    test_image = image.load_img(imagename, target_size = (224,224))
  File "/home/louay/PycharmProjects/KidneyDisease/.venv3.10/lib/python3.10/site-packages/keras/utils/image_utils.py", line 423, in load_img
    img = pil_image.open(io.BytesIO(f.read()))
  File "/home/louay/PycharmProjects/KidneyDisease/.venv3.10/lib/python3.10/site-packages/PIL/Image.py", line 3572, in open
    raise UnidentifiedImageError(msg)
PIL.UnidentifiedImageError: cannot identify image file <_io.BytesIO object at 0x7230effd3380>
[2025-04-27 22:15:28,265: INFO: _internal: 127.0.0.1 - - [27/Apr/2025 22:15:28] "[35m[1mPOST /predict HTTP/1.1[0m" 500 -]
[2025-04-27 22:20:06,488: WARNING: polymorphic_function: 5 out of the last 5 calls to <function Model.make_predict_function.<locals>.predict_function at 0x7230eff4c8b0> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.]
[2025-04-27 22:20:06,490: INFO: _internal: 127.0.0.1 - - [27/Apr/2025 22:20:06] "POST /predict HTTP/1.1" 200 -]
[2025-04-27 22:20:24,225: WARNING: polymorphic_function: 6 out of the last 6 calls to <function Model.make_predict_function.<locals>.predict_function at 0x7230eff4c9d0> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.]
[2025-04-27 22:20:24,227: INFO: _internal: 127.0.0.1 - - [27/Apr/2025 22:20:24] "POST /predict HTTP/1.1" 200 -]
